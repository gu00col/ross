<!-- =============================================== -->
<!-- Conteúdo Principal (Main Content) -->
<!-- =============================================== -->
<main class="main-content flex-grow-1 p-4" id="page-home">
    <!-- Header Mobile com botão para abrir o Offcanvas -->
    <div class="d-md-none d-flex justify-content-between align-items-center mb-4 mobile-header">
        <h5 class="logo-title text-dark mb-0">ROSS</h5>
        <button class="btn" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileMenu" aria-controls="mobileMenu">
            <i class="bi bi-list fs-3" style="color: var(--primary-dark-blue);"></i>
        </button>
    </div>

    <div class="container-fluid px-0">
        <!-- Cabeçalho do Dashboard -->
        <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
            <div>
                <h2 class="display-6 mb-0">Visão Geral</h2>
                <p class="text-muted mb-0">Análise de Contratos</p>
            </div>
            <a href="#" class="btn btn-primary d-flex align-items-center">
                <i class="bi bi-plus-lg me-2"></i> Nova Análise
            </a>
        </div>

        <!-- Linha de Cards com Estatísticas -->
        <div class="row g-4 mb-4">
            <div class="col-lg-3 col-md-6">
                <div class="card stat-card text-center h-100">
                    <div class="card-body p-3 d-flex flex-column justify-content-center">
                        <h5 class="card-title text-info-emphasis">Enviados Hoje</h5>
                        <p class="display-5"><?= $this->view->dashboardStats['sent_today'] ?? 0 ?></p>
                        <div class="text-muted"><i class="bi bi-calendar-day me-1"></i>Últimas 24h</div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="card stat-card text-center h-100">
                    <div class="card-body p-3 d-flex flex-column justify-content-center">
                        <h5 class="card-title text-warning-emphasis">Pendentes</h5>
                        <p class="display-5"><?= $this->view->dashboardStats['pending'] ?? 0 ?></p>
                         <div class="text-muted"><i class="bi bi-clock-history me-1"></i>Aguardando análise</div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="card stat-card text-center h-100">
                    <div class="card-body p-3 d-flex flex-column justify-content-center">
                        <h5 class="card-title text-success-emphasis">Processados</h5>
                        <p class="display-5"><?= $this->view->dashboardStats['processed'] ?? 0 ?></p>
                         <div class="text-muted"><i class="bi bi-check-circle me-1"></i>Análise concluída</div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="card stat-card text-center h-100">
                    <div class="card-body p-3 d-flex flex-column justify-content-center">
                        <h5 class="card-title text-danger-emphasis">Com Erro</h5>
                        <p class="display-5"><?= $this->view->dashboardStats['with_error'] ?? 0 ?></p>
                        <div class="text-muted"><i class="bi bi-exclamation-triangle me-1"></i>Requerem atenção</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabela de Últimos Contratos -->
        <h3 class="mb-3">Últimas Análises</h3>
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th scope="col">Nome do Contrato</th>
                                <th scope="col">Status</th>
                                <th scope="col">Data de Envio</th>
                            </tr>
                        </thead>
                        <tbody>
                            <?php if (empty($this->view->latestContracts)) { ?>
                                <tr>
                                    <td colspan="3" class="text-center">Nenhum contrato encontrado.</td>
                                </tr>
                            <?php } else { ?>
                                <?php 
                                foreach ($this->view->latestContracts as $contract) { 
                                    $status = App\Helpers\StatusHelper::formatStatus($contract['status']);
                                    $formatted_date = date('d/m/Y', strtotime($contract['created_at']));
                                ?>
                                    <tr>
                                        <td><?= htmlspecialchars(str_replace('.pdf', '', $contract['original_filename'])) ?></td>
                                        <td><span class="badge <?= $status['class'] ?> rounded-pill"><?= htmlspecialchars($status['text']) ?></span></td>
                                        <td><?= $formatted_date ?></td>
                                    </tr>
                                <?php } ?>
                            <?php } ?>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
</main>

